name: Copia dei File Generati

on:
    push:
        branches: [83-action]

jobs:
    copy:
        runs-on: ubuntu-latest

        steps:

        - name: Aggiornamento del sistema
          run: |
            sudo apt-get update -y
            sudo apt-get upgrade -y


        - name: Installazione di apt-utils
          run:  sudo apt-get install -y apt-utils
        
        - name: Installazione di Git
          run:  |
                  sudo apt-get update -y
                  sudo apt-get install git -y

        - name: Copia dei File
          uses: actions/checkout@v2

        - name: Copia dei Documenti Interni
          run : find docs/interni/ -name '*.pdf' -exec cp {} public/interni \;

        - name: Copia dei Documenti Esterni
          run : find docs/esterni/ -name '*.pdf' -exec cp {} public/esterni \;

        - name: Copia dei Verbali Interni
          run : find docs/interni/verbali -name '*.pdf' -exec cp {} public/interni/verbali \;

        - name: Copia dei Verbali Esterni
          run : find docs/esterni/verbali -name '*.pdf' -exec cp {} public/esterni/verbali \;

        - name: Commit dei File
          run : |
            git config --local user.email "action@github.com"
            git config --local user.name "GitHub Action"

            git add *.pdf
            git commit -m "Aggiornamento Automatico Documenti"

        - name: Push dei File
          uses: ad-m/github-push-action@master
          with:
            branch: 83-action
            github_token: ${{ secrets.GITHUB_TOKEN }}